<div class="form-container">
  <div class="form-card">
    <div *ngIf="cargando" class="loading-center">
      <div class="spinner"></div>
      <p>Cargando cotizaci√≥n...</p>
    </div>

    <div *ngIf="!cargando">
      <h1>üìã Crear Negocio desde Cotizaci√≥n</h1>
      <p class="subtitle">Genera un nuevo negocio a partir de una cotizaci√≥n aprobada</p>

      <form (ngSubmit)="guardar()" class="formulario">
        <!-- SECCI√ìN 1: Informaci√≥n de la Cotizaci√≥n (READ-ONLY) -->
        <div class="seccion read-only-section">
          <div class="section-header">
            <h3>üìù COTIZACI√ìN ORIGEN</h3>
            <span class="info-label">(Informaci√≥n de referencia)</span>
          </div>

          <div *ngIf="cotizacion" class="info-grid">
            <div class="info-item">
              <label>C√≥digo</label>
              <p class="value">{{ cotizacion.codigo }}</p>
            </div>
            <div class="info-item">
              <label>Cliente</label>
              <p class="value">{{ cotizacion.cliente.nombre }}</p>
            </div>
            <div class="info-item">
              <label>Subtotal</label>
              <p class="value">${{ cotizacion.subtotal | number: '1.2-2' }}</p>
            </div>
            <div class="info-item">
              <label>Impuestos</label>
              <p class="value">${{ cotizacion.impuestos | number: '1.2-2' }}</p>
            </div>
            <div class="info-item">
              <label>Total</label>
              <p class="value monto">${{ cotizacion.total | number: '1.2-2' }}</p>
            </div>
            <div class="info-item">
              <label>Estado</label>
              <p><span class="badge badge-success">{{ cotizacion.estado }}</span></p>
            </div>
          </div>

          <div *ngIf="cotizacion && cotizacion.descripcion" class="info-section">
            <label>Descripci√≥n</label>
            <p class="value">{{ cotizacion.descripcion }}</p>
          </div>
        </div>

        <!-- SECCI√ìN 2: Datos del Negocio (EDITABLES) -->
        <div class="seccion editable-section">
          <div class="section-header">
            <h3>üíº DATOS DEL NEGOCIO</h3>
            <span class="info-label">(Informaci√≥n a completar)</span>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="fechaInicio">Fecha Inicio *</label>
              <input
                type="date"
                id="fechaInicio"
                [(ngModel)]="negocio.fechaInicio"
                name="fechaInicio"
                [disabled]="loading"
                required />
            </div>

            <div class="form-group">
              <label for="fechaFinEstimada">Fecha Fin Estimada *</label>
              <input
                type="date"
                id="fechaFinEstimada"
                [(ngModel)]="negocio.fechaFinEstimada"
                name="fechaFinEstimada"
                [disabled]="loading"
                required />
            </div>
          </div>

          <div class="form-group">
            <label for="descripcion">Descripci√≥n del Negocio *</label>
            <textarea
              id="descripcion"
              [(ngModel)]="negocio.descripcion"
              name="descripcion"
              placeholder="Describe el negocio a realizar"
              rows="3"
              [disabled]="loading"
              required></textarea>
            <small>Esta informaci√≥n se utilizar√° para documentar el prop√≥sito del negocio</small>
          </div>

          <div class="form-group">
            <label for="observaciones">Observaciones</label>
            <textarea
              id="observaciones"
              [(ngModel)]="negocio.observaciones"
              name="observaciones"
              placeholder="Notas adicionales (opcional)"
              rows="2"
              [disabled]="loading"></textarea>
          </div>
        </div>

        <!-- Mensajes de Error -->
        <div class="error" *ngIf="error">
          <span class="error-icon">‚ö†Ô∏è</span>
          {{ error }}
        </div>

        <!-- Botones de Acci√≥n -->
        <div class="form-actions">
          <button type="submit" class="btn btn-primary" [disabled]="loading">
            <span *ngIf="!loading">‚úì Crear Negocio</span>
            <span *ngIf="loading">‚è≥ Creando...</span>
          </button>
          <button type="button" class="btn btn-secondary" (click)="cancelar()" [disabled]="loading">
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
